/*! howler.js v2.0.4 | (c) 2013-2017, James Simpson of GoldFire Studios | MIT License | howlerjs.com */!function(){"use strict";var e=function(){this.init()};e.prototype={init:function(){var e=this||t;return e._counter=1e3,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.mobileAutoEnable=!0,e._setup(),e},volume:function(e){var i=this||t;if(e=parseFloat(e),i.ctx||T(),void 0!==e&&e>=0&&e<=1){if(i._volume=e,i._muted)return i;i.usingWebAudio&&(i.masterGain.gain.value=e);for(var r=0;r<i._howls.length;r++)if(!i._howls[r]._webAudio)for(var a=i._howls[r]._getSoundIds(),n=0;n<a.length;n++){var o=i._howls[r]._soundById(a[n]);o&&o._node&&(o._node.volume=o._volume*e)}return i}return i._volume},mute:function(e){var i=this||t;i.ctx||T(),i._muted=e,i.usingWebAudio&&(i.masterGain.gain.value=e?0:i._volume);for(var r=0;r<i._howls.length;r++)if(!i._howls[r]._webAudio)for(var a=i._howls[r]._getSoundIds(),n=0;n<a.length;n++){var o=i._howls[r]._soundById(a[n]);o&&o._node&&(o._node.muted=!!e||o._muted)}return i},unload:function(){for(var e=this||t,i=e._howls.length-1;i>=0;i--)e._howls[i].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,T()),e},codecs:function(e){return(this||t)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||t;if(e.state=e.ctx&&e.ctx.state||"running",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||t,i=null;try{i="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!i||"function"!=typeof i.canPlayType)return e;var r=i.canPlayType("audio/mpeg;").replace(/^no$/,""),a=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),n=a&&parseInt(a[0].split("/")[1],10)<33;return e._codecs={mp3:!(n||!r&&!i.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!r,opus:!!i.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!i.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!i.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!i.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(i.canPlayType("audio/x-mp4;")||i.canPlayType("audio/mp4;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!i.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(i.canPlayType("audio/x-flac;")||i.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_enableMobileAudio:function(){var e=this||t,i=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(e._navigator&&e._navigator.userAgent),r=!!("ontouchend"in window||e._navigator&&e._navigator.maxTouchPoints>0||e._navigator&&e._navigator.msMaxTouchPoints>0);if(!e._mobileEnabled&&e.ctx&&(i||r)){e._mobileEnabled=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var a=function(){t._autoResume();var i=e.ctx.createBufferSource();i.buffer=e._scratchBuffer,i.connect(e.ctx.destination),void 0===i.start?i.noteOn(0):i.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),i.onended=function(){i.disconnect(0),e._mobileEnabled=!0,e.mobileAutoEnable=!1,document.removeEventListener("touchend",a,!0)}};return document.addEventListener("touchend",a,!0),e}},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&t.usingWebAudio){for(var i=0;i<e._howls.length;i++)if(e._howls[i]._webAudio)for(var r=0;r<e._howls[i]._sounds.length;r++)if(!e._howls[i]._sounds[r]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then((function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())})))}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&t.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var t=new e,i=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};i.prototype={init:function(e){var i=this;return t.ctx||T(),i._autoplay=e.autoplay||!1,i._format="string"!=typeof e.format?e.format:[e.format],i._html5=e.html5||!1,i._muted=e.mute||!1,i._loop=e.loop||!1,i._pool=e.pool||5,i._preload="boolean"!=typeof e.preload||e.preload,i._rate=e.rate||1,i._sprite=e.sprite||{},i._src="string"!=typeof e.src?e.src:[e.src],i._volume=void 0!==e.volume?e.volume:1,i._duration=0,i._state="unloaded",i._sounds=[],i._endTimers={},i._queue=[],i._onend=e.onend?[{fn:e.onend}]:[],i._onfade=e.onfade?[{fn:e.onfade}]:[],i._onload=e.onload?[{fn:e.onload}]:[],i._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],i._onpause=e.onpause?[{fn:e.onpause}]:[],i._onplay=e.onplay?[{fn:e.onplay}]:[],i._onstop=e.onstop?[{fn:e.onstop}]:[],i._onmute=e.onmute?[{fn:e.onmute}]:[],i._onvolume=e.onvolume?[{fn:e.onvolume}]:[],i._onrate=e.onrate?[{fn:e.onrate}]:[],i._onseek=e.onseek?[{fn:e.onseek}]:[],i._onresume=[],i._webAudio=t.usingWebAudio&&!i._html5,void 0!==t.ctx&&t.ctx&&t.mobileAutoEnable&&t._enableMobileAudio(),t._howls.push(i),i._autoplay&&i._queue.push({event:"play",action:function(){i.play()}}),i._preload&&i.load(),i},load:function(){var e=this,i=null;if(!t.noAudio){"string"==typeof e._src&&(e._src=[e._src]);for(var a=0;a<e._src.length;a++){var o,s;if(e._format&&e._format[a])o=e._format[a];else{if("string"!=typeof(s=e._src[a])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(o=/^data:audio\/([^;,]+);/i.exec(s))||(o=/\.([^.]+)$/.exec(s.split("?",1)[0])),o&&(o=o[1].toLowerCase())}if(o||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),o&&t.codecs(o)){i=e._src[a];break}}return i?(e._src=i,e._state="loading","https:"===window.location.protocol&&"http:"===i.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new r(e),e._webAudio&&n(e),e):void e._emit("loaderror",null,"No codec support for selected audio sources.")}e._emit("loaderror",null,"No audio support.")},play:function(e,i){var r=this,a=null;if("number"==typeof e)a=e,e=null;else{if("string"==typeof e&&"loaded"===r._state&&!r._sprite[e])return null;if(void 0===e){e="__default";for(var n=0,o=0;o<r._sounds.length;o++)r._sounds[o]._paused&&!r._sounds[o]._ended&&(n++,a=r._sounds[o]._id);1===n?e=null:a=null}}var s=a?r._soundById(a):r._inactiveSound();if(!s)return null;if(a&&!e&&(e=s._sprite||"__default"),"loaded"!==r._state){s._sprite=e,s._ended=!1;var _=s._id;return r._queue.push({event:"play",action:function(){r.play(_)}}),_}if(a&&!s._paused)return i||setTimeout((function(){r._emit("play",s._id)}),0),s._id;r._webAudio&&t._autoResume();var T=Math.max(0,s._seek>0?s._seek:r._sprite[e][0]/1e3),E=Math.max(0,(r._sprite[e][0]+r._sprite[e][1])/1e3-T),I=1e3*E/Math.abs(s._rate);s._paused=!1,s._ended=!1,s._sprite=e,s._seek=T,s._start=r._sprite[e][0]/1e3,s._stop=(r._sprite[e][0]+r._sprite[e][1])/1e3,s._loop=!(!s._loop&&!r._sprite[e][2]);var l=s._node;if(r._webAudio){var u=function(){r._refreshBuffer(s);var e=s._muted||r._muted?0:s._volume;l.gain.setValueAtTime(e,t.ctx.currentTime),s._playStart=t.ctx.currentTime,void 0===l.bufferSource.start?s._loop?l.bufferSource.noteGrainOn(0,T,86400):l.bufferSource.noteGrainOn(0,T,E):s._loop?l.bufferSource.start(0,T,86400):l.bufferSource.start(0,T,E),I!==1/0&&(r._endTimers[s._id]=setTimeout(r._ended.bind(r,s),I)),i||setTimeout((function(){r._emit("play",s._id)}),0)},d="running"===t.state;if("loaded"===r._state&&d)u();else{var R=d||"loaded"!==r._state?"load":"resume";r.once(R,u,d?s._id:null),r._clearTimer(s._id)}}else{var A=function(){l.currentTime=T,l.muted=s._muted||r._muted||t._muted||l.muted,l.volume=s._volume*t.volume(),l.playbackRate=s._rate,l.play(),I!==1/0&&(r._endTimers[s._id]=setTimeout(r._ended.bind(r,s),I)),i||r._emit("play",s._id)},c="loaded"===r._state&&(window&&window.ejecta||!l.readyState&&t._navigator.isCocoonJS);if(4===l.readyState||c)A();else{var h=function(){A(),l.removeEventListener(t._canPlayEvent,h,!1)};l.addEventListener(t._canPlayEvent,h,!1),r._clearTimer(s._id)}}return s._id},pause:function(e){var t=this;if("loaded"!==t._state)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var i=t._getSoundIds(e),r=0;r<i.length;r++){t._clearTimer(i[r]);var a=t._soundById(i[r]);if(a&&!a._paused&&(a._seek=t.seek(i[r]),a._rateSeek=0,a._paused=!0,t._stopFade(i[r]),a._node))if(t._webAudio){if(!a._node.bufferSource)continue;void 0===a._node.bufferSource.stop?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),t._cleanBuffer(a._node)}else isNaN(a._node.duration)&&a._node.duration!==1/0||a._node.pause();arguments[1]||t._emit("pause",a?a._id:null)}return t},stop:function(e,t){var i=this;if("loaded"!==i._state)return i._queue.push({event:"stop",action:function(){i.stop(e)}}),i;for(var r=i._getSoundIds(e),a=0;a<r.length;a++){i._clearTimer(r[a]);var n=i._soundById(r[a]);n&&(n._seek=n._start||0,n._rateSeek=0,n._paused=!0,n._ended=!0,i._stopFade(r[a]),n._node&&(i._webAudio?n._node.bufferSource&&(void 0===n._node.bufferSource.stop?n._node.bufferSource.noteOff(0):n._node.bufferSource.stop(0),i._cleanBuffer(n._node)):isNaN(n._node.duration)&&n._node.duration!==1/0||(n._node.currentTime=n._start||0,n._node.pause())),t||i._emit("stop",n._id))}return i},mute:function(e,i){var r=this;if("loaded"!==r._state)return r._queue.push({event:"mute",action:function(){r.mute(e,i)}}),r;if(void 0===i){if("boolean"!=typeof e)return r._muted;r._muted=e}for(var a=r._getSoundIds(i),n=0;n<a.length;n++){var o=r._soundById(a[n]);o&&(o._muted=e,r._webAudio&&o._node?o._node.gain.setValueAtTime(e?0:o._volume,t.ctx.currentTime):o._node&&(o._node.muted=!!t._muted||e),r._emit("mute",o._id))}return r},volume:function(){var e,i,r,a=this,n=arguments;if(0===n.length)return a._volume;if(1===n.length||2===n.length&&void 0===n[1]?a._getSoundIds().indexOf(n[0])>=0?i=parseInt(n[0],10):e=parseFloat(n[0]):n.length>=2&&(e=parseFloat(n[0]),i=parseInt(n[1],10)),!(void 0!==e&&e>=0&&e<=1))return(r=i?a._soundById(i):a._sounds[0])?r._volume:0;if("loaded"!==a._state)return a._queue.push({event:"volume",action:function(){a.volume.apply(a,n)}}),a;void 0===i&&(a._volume=e),i=a._getSoundIds(i);for(var o=0;o<i.length;o++)(r=a._soundById(i[o]))&&(r._volume=e,n[2]||a._stopFade(i[o]),a._webAudio&&r._node&&!r._muted?r._node.gain.setValueAtTime(e,t.ctx.currentTime):r._node&&!r._muted&&(r._node.volume=e*t.volume()),a._emit("volume",r._id));return a},fade:function(e,i,r,a){var n=this,o=Math.abs(e-i),s=e>i?"out":"in",_=o/.01,T=_>0?r/_:r;if(T<4&&(_=Math.ceil(_/(4/T)),T=4),"loaded"!==n._state)return n._queue.push({event:"fade",action:function(){n.fade(e,i,r,a)}}),n;n.volume(e,a);for(var E=n._getSoundIds(a),I=0;I<E.length;I++){var l=n._soundById(E[I]);if(l){if(a||n._stopFade(E[I]),n._webAudio&&!l._muted){var u=t.ctx.currentTime,d=u+r/1e3;l._volume=e,l._node.gain.setValueAtTime(e,u),l._node.gain.linearRampToValueAtTime(i,d)}var R=e;l._interval=setInterval(function(t,r){_>0&&(R+="in"===s?.01:-.01),R=Math.max(0,R),R=Math.min(1,R),R=Math.round(100*R)/100,n._webAudio?(void 0===a&&(n._volume=R),r._volume=R):n.volume(R,t,!0),(i<e&&R<=i||i>e&&R>=i)&&(clearInterval(r._interval),r._interval=null,n.volume(i,t),n._emit("fade",t))}.bind(n,E[I],l),T)}}return n},_stopFade:function(e){var i=this,r=i._soundById(e);return r&&r._interval&&(i._webAudio&&r._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(r._interval),r._interval=null,i._emit("fade",e)),i},loop:function(){var e,t,i,r=this,a=arguments;if(0===a.length)return r._loop;if(1===a.length){if("boolean"!=typeof a[0])return!!(i=r._soundById(parseInt(a[0],10)))&&i._loop;e=a[0],r._loop=e}else 2===a.length&&(e=a[0],t=parseInt(a[1],10));for(var n=r._getSoundIds(t),o=0;o<n.length;o++)(i=r._soundById(n[o]))&&(i._loop=e,r._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=e,e&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop)));return r},rate:function(){var e,i,r,a=this,n=arguments;if(0===n.length)i=a._sounds[0]._id;else if(1===n.length){var o=a._getSoundIds(),s=o.indexOf(n[0]);s>=0?i=parseInt(n[0],10):e=parseFloat(n[0])}else 2===n.length&&(e=parseFloat(n[0]),i=parseInt(n[1],10));if("number"!=typeof e)return(r=a._soundById(i))?r._rate:a._rate;if("loaded"!==a._state)return a._queue.push({event:"rate",action:function(){a.rate.apply(a,n)}}),a;void 0===i&&(a._rate=e),i=a._getSoundIds(i);for(var _=0;_<i.length;_++)if(r=a._soundById(i[_])){r._rateSeek=a.seek(i[_]),r._playStart=a._webAudio?t.ctx.currentTime:r._playStart,r._rate=e,a._webAudio&&r._node&&r._node.bufferSource?r._node.bufferSource.playbackRate.value=e:r._node&&(r._node.playbackRate=e);var T=a.seek(i[_]),E=(a._sprite[r._sprite][0]+a._sprite[r._sprite][1])/1e3-T,I=1e3*E/Math.abs(r._rate);!a._endTimers[i[_]]&&r._paused||(a._clearTimer(i[_]),a._endTimers[i[_]]=setTimeout(a._ended.bind(a,r),I)),a._emit("rate",r._id)}return a},seek:function(){var e,i,r=this,a=arguments;if(0===a.length)i=r._sounds[0]._id;else if(1===a.length){var n=r._getSoundIds(),o=n.indexOf(a[0]);o>=0?i=parseInt(a[0],10):(i=r._sounds[0]._id,e=parseFloat(a[0]))}else 2===a.length&&(e=parseFloat(a[0]),i=parseInt(a[1],10));if(void 0===i)return r;if("loaded"!==r._state)return r._queue.push({event:"seek",action:function(){r.seek.apply(r,a)}}),r;var s=r._soundById(i);if(s){if(!("number"==typeof e&&e>=0)){if(r._webAudio){var _=r.playing(i)?t.ctx.currentTime-s._playStart:0,T=s._rateSeek?s._rateSeek-s._seek:0;return s._seek+(T+_*Math.abs(s._rate))}return s._node.currentTime}var E=r.playing(i);E&&r.pause(i,!0),s._seek=e,s._ended=!1,r._clearTimer(i),E&&r.play(i,!0),!r._webAudio&&s._node&&(s._node.currentTime=e),r._emit("seek",i)}return r},playing:function(e){var t=this;if("number"==typeof e){var i=t._soundById(e);return!!i&&!i._paused}for(var r=0;r<t._sounds.length;r++)if(!t._sounds[r]._paused)return!0;return!1},duration:function(e){var t=this,i=t._duration,r=t._soundById(e);return r&&(i=t._sprite[r._sprite][1]/1e3),i},state:function(){return this._state},unload:function(){for(var e=this,i=e._sounds,r=0;r<i.length;r++){i[r]._paused||e.stop(i[r]._id),e._webAudio||(/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent)||(i[r]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),i[r]._node.removeEventListener("error",i[r]._errorFn,!1),i[r]._node.removeEventListener(t._canPlayEvent,i[r]._loadFn,!1)),delete i[r]._node,e._clearTimer(i[r]._id);var n=t._howls.indexOf(e);n>=0&&t._howls.splice(n,1)}var o=!0;for(r=0;r<t._howls.length;r++)if(t._howls[r]._src===e._src){o=!1;break}return a&&o&&delete a[e._src],t.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,i,r){var a=this["_on"+e];return"function"==typeof t&&a.push(r?{id:i,fn:t,once:r}:{id:i,fn:t}),this},off:function(e,t,i){var r=this,a=r["_on"+e],n=0;if("number"==typeof t&&(i=t,t=null),t||i)for(n=0;n<a.length;n++){var o=i===a[n].id;if(t===a[n].fn&&o||!t&&o){a.splice(n,1);break}}else if(e)r["_on"+e]=[];else{var s=Object.keys(r);for(n=0;n<s.length;n++)0===s[n].indexOf("_on")&&Array.isArray(r[s[n]])&&(r[s[n]]=[])}return r},once:function(e,t,i){return this.on(e,t,i,1),this},_emit:function(e,t,i){for(var r=this,a=r["_on"+e],n=a.length-1;n>=0;n--)a[n].id&&a[n].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,i)}.bind(r,a[n].fn),0),a[n].once&&r.off(e,a[n].fn,a[n].id));return r},_loadQueue:function(){var e=this;if(e._queue.length>0){var t=e._queue[0];e.once(t.event,(function(){e._queue.shift(),e._loadQueue()})),t.action()}return e},_ended:function(e){var i=this,r=e._sprite;if(!i._webAudio&&i._node&&!i._node.ended)return setTimeout(i._ended.bind(i,e),100),i;var a=!(!e._loop&&!i._sprite[r][2]);if(i._emit("end",e._id),!i._webAudio&&a&&i.stop(e._id,!0).play(e._id),i._webAudio&&a){i._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=t.ctx.currentTime;var n=1e3*(e._stop-e._start)/Math.abs(e._rate);i._endTimers[e._id]=setTimeout(i._ended.bind(i,e),n)}return i._webAudio&&!a&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,i._clearTimer(e._id),i._cleanBuffer(e._node),t._autoSuspend()),i._webAudio||a||i.stop(e._id),i},_clearTimer:function(e){var t=this;return t._endTimers[e]&&(clearTimeout(t._endTimers[e]),delete t._endTimers[e]),t},_soundById:function(e){for(var t=this,i=0;i<t._sounds.length;i++)if(e===t._sounds[i]._id)return t._sounds[i];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new r(e)},_drain:function(){var e=this,t=e._pool,i=0,r=0;if(!(e._sounds.length<t)){for(r=0;r<e._sounds.length;r++)e._sounds[r]._ended&&i++;for(r=e._sounds.length-1;r>=0;r--){if(i<=t)return;e._sounds[r]._ended&&(e._webAudio&&e._sounds[r]._node&&e._sounds[r]._node.disconnect(0),e._sounds.splice(r,1),i--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],i=0;i<this._sounds.length;i++)t.push(this._sounds[i]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=t.ctx.createBufferSource(),e._node.bufferSource.buffer=a[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.value=e._rate,this},_cleanBuffer:function(e){var t=this;if(t._scratchBuffer){e.bufferSource.onended=null,e.bufferSource.disconnect(0);try{e.bufferSource.buffer=t._scratchBuffer}catch(e){}}return e.bufferSource=null,t}};var r=function(e){this._parent=e,this.init()};r.prototype={init:function(){var e=this,i=e._parent;return e._muted=i._muted,e._loop=i._loop,e._volume=i._volume,e._rate=i._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++t._counter,i._sounds.push(e),e.create(),e},create:function(){var e=this,i=e._parent,r=t._muted||e._muted||e._parent._muted?0:e._volume;return i._webAudio?(e._node=void 0===t.ctx.createGain?t.ctx.createGainNode():t.ctx.createGain(),e._node.gain.setValueAtTime(r,t.ctx.currentTime),e._node.paused=!0,e._node.connect(t.masterGain)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(t._canPlayEvent,e._loadFn,!1),e._node.src=i._src,e._node.preload="auto",e._node.volume=r*t.volume(),e._node.load()),e},reset:function(){var e=this,i=e._parent;return e._muted=i._muted,e._loop=i._loop,e._volume=i._volume,e._rate=i._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++t._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,i=e._parent;i._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(i._sprite).length&&(i._sprite={__default:[0,1e3*i._duration]}),"loaded"!==i._state&&(i._state="loaded",i._emit("load"),i._loadQueue()),e._node.removeEventListener(t._canPlayEvent,e._loadFn,!1)}};var a={},n=function(e){var t=e._src;if(a[t])return e._duration=a[t].duration,void _(e);if(/^data:[^;]+;base64,/.test(t)){for(var i=atob(t.split(",")[1]),r=new Uint8Array(i.length),n=0;n<i.length;++n)r[n]=i.charCodeAt(n);s(r.buffer,e)}else{var T=new XMLHttpRequest;T.open("GET",t,!0),T.responseType="arraybuffer",T.onload=function(){var t=(T.status+"")[0];"0"===t||"2"===t||"3"===t?s(T.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+T.status+".")},T.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete a[t],e.load())},o(T)}},o=function(e){try{e.send()}catch(t){e.onerror()}},s=function(e,i){t.ctx.decodeAudioData(e,(function(e){e&&i._sounds.length>0&&(a[i._src]=e,_(i,e))}),(function(){i._emit("loaderror",null,"Decoding audio data failed.")}))},_=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},T=function(){try{"undefined"!=typeof AudioContext?t.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch(e){t.usingWebAudio=!1}var e=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),i=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),r=i?parseInt(i[1],10):null;if(e&&r&&r<9){var a=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());(t._navigator&&t._navigator.standalone&&!a||t._navigator&&!t._navigator.standalone&&!a)&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=void 0===t.ctx.createGain?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.value=t._muted?0:1,t.masterGain.connect(t.ctx.destination)),t._setup()};"function"==typeof define&&define.amd&&define([],(function(){return{Howler:t,Howl:i}})),"undefined"!=typeof exports&&(exports.Howler=t,exports.Howl=i),"undefined"!=typeof window?(window.HowlerGlobal=e,window.Howler=t,window.Howl=i,window.Sound=r):"undefined"!=typeof global&&(global.HowlerGlobal=e,global.Howler=t,global.Howl=i,global.Sound=r)}(),function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var i=t._howls.length-1;i>=0;i--)t._howls[i].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,i){var r=this;return r.ctx&&r.ctx.listener?(t="number"!=typeof t?r._pos[1]:t,i="number"!=typeof i?r._pos[2]:i,"number"!=typeof e?r._pos:(r._pos=[e,t,i],r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2]),r)):r},HowlerGlobal.prototype.orientation=function(e,t,i,r,a,n){var o=this;if(!o.ctx||!o.ctx.listener)return o;var s=o._orientation;return t="number"!=typeof t?s[1]:t,i="number"!=typeof i?s[2]:i,r="number"!=typeof r?s[3]:r,a="number"!=typeof a?s[4]:a,n="number"!=typeof n?s[5]:n,"number"!=typeof e?s:(o._orientation=[e,t,i,r,a,n],o.ctx.listener.setOrientation(e,t,i,r,a,n),o)},Howl.prototype.init=function(e){return function(t){var i=this;return i._orientation=t.orientation||[1,0,0],i._stereo=t.stereo||null,i._pos=t.pos||null,i._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},i._onstereo=t.onstereo?[{fn:t.onstereo}]:[],i._onpos=t.onpos?[{fn:t.onpos}]:[],i._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,i){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"stereo",action:function(){r.stereo(t,i)}}),r;var a=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===i){if("number"!=typeof t)return r._stereo;r._stereo=t,r._pos=[t,0,0]}for(var n=r._getSoundIds(i),o=0;o<n.length;o++){var s=r._soundById(n[o]);if(s){if("number"!=typeof t)return s._stereo;s._stereo=t,s._pos=[t,0,0],s._node&&(s._pannerAttr.panningModel="equalpower",s._panner&&s._panner.pan||e(s,a),"spatial"===a?s._panner.setPosition(t,0,0):s._panner.pan.value=t),r._emit("stereo",s._id)}}return r},Howl.prototype.pos=function(t,i,r,a){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"pos",action:function(){n.pos(t,i,r,a)}}),n;if(i="number"!=typeof i?0:i,r="number"!=typeof r?-.5:r,void 0===a){if("number"!=typeof t)return n._pos;n._pos=[t,i,r]}for(var o=n._getSoundIds(a),s=0;s<o.length;s++){var _=n._soundById(o[s]);if(_){if("number"!=typeof t)return _._pos;_._pos=[t,i,r],_._node&&(_._panner&&!_._panner.pan||e(_,"spatial"),_._panner.setPosition(t,i,r)),n._emit("pos",_._id)}}return n},Howl.prototype.orientation=function(t,i,r,a){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"orientation",action:function(){n.orientation(t,i,r,a)}}),n;if(i="number"!=typeof i?n._orientation[1]:i,r="number"!=typeof r?n._orientation[2]:r,void 0===a){if("number"!=typeof t)return n._orientation;n._orientation=[t,i,r]}for(var o=n._getSoundIds(a),s=0;s<o.length;s++){var _=n._soundById(o[s]);if(_){if("number"!=typeof t)return _._orientation;_._orientation=[t,i,r],_._node&&(_._panner||(_._pos||(_._pos=n._pos||[0,0,-.5]),e(_,"spatial")),_._panner.setOrientation(t,i,r)),n._emit("orientation",_._id)}}return n},Howl.prototype.pannerAttr=function(){var t,i,r,a=this,n=arguments;if(!a._webAudio)return a;if(0===n.length)return a._pannerAttr;if(1===n.length){if("object"!=typeof n[0])return(r=a._soundById(parseInt(n[0],10)))?r._pannerAttr:a._pannerAttr;t=n[0],void 0===i&&(a._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:a._coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:a._coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:a._coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:a._distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:a._maxDistance,panningModel:void 0!==t.panningModel?t.panningModel:a._panningModel,refDistance:void 0!==t.refDistance?t.refDistance:a._refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:a._rolloffFactor})}else 2===n.length&&(t=n[0],i=parseInt(n[1],10));for(var o=a._getSoundIds(i),s=0;s<o.length;s++)if(r=a._soundById(o[s])){var _=r._pannerAttr;_={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:_.coneInnerAngle,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:_.coneOuterAngle,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:_.coneOuterGain,distanceModel:void 0!==t.distanceModel?t.distanceModel:_.distanceModel,maxDistance:void 0!==t.maxDistance?t.maxDistance:_.maxDistance,panningModel:void 0!==t.panningModel?t.panningModel:_.panningModel,refDistance:void 0!==t.refDistance?t.refDistance:_.refDistance,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:_.rolloffFactor};var T=r._panner;T?(T.coneInnerAngle=_.coneInnerAngle,T.coneOuterAngle=_.coneOuterAngle,T.coneOuterGain=_.coneOuterGain,T.distanceModel=_.distanceModel,T.maxDistance=_.maxDistance,T.panningModel=_.panningModel,T.refDistance=_.refDistance,T.rolloffFactor=_.rolloffFactor):(r._pos||(r._pos=a._pos||[0,0,-.5]),e(r,"spatial"))}return a},Sound.prototype.init=function(e){return function(){var t=this,i=t._parent;t._orientation=i._orientation,t._stereo=i._stereo,t._pos=i._pos,t._pannerAttr=i._pannerAttr,e.call(this),t._stereo?i.stereo(t._stereo):t._pos&&i.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,i=t._parent;return t._orientation=i._orientation,t._pos=i._pos,t._pannerAttr=i._pannerAttr,e.call(this)}}(Sound.prototype.reset);var e=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.panningModel=e._pannerAttr.panningModel,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.value=e._stereo),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id)}}();var VOLUME={AMB:1,FX:1},CONST_AUDIO={SEA_DELAY:12,SEA_FADE:5e3,FOREST_DELAY:12,FOREST_FADE:5e3,SNOW_DELAY:12,SNOW_FADE:5e3,TRANSITION:3e3,DISABLE_EFFECT:46e4,PLAYERS:8,ITEMS:6,HAND:1,MISC:2,SHOVEL:3},SOUND=[];SOUND[-1]=CONST_AUDIO.HAND,SOUND[INV.BOOK]=CONST_AUDIO.HAND,SOUND[INV.WATERING_CAN_FULL]=CONST_AUDIO.HAND,SOUND[INV.WRENCH]=CONST_AUDIO.MISC,SOUND[INV.PICK_WOOD]=CONST_AUDIO.MISC,SOUND[INV.PICK]=CONST_AUDIO.MISC,SOUND[INV.PICK_GOLD]=CONST_AUDIO.MISC,SOUND[INV.PICK_DIAMOND]=CONST_AUDIO.MISC,SOUND[INV.PICK_AMETHYST]=CONST_AUDIO.MISC,SOUND[INV.PICK_REIDITE]=CONST_AUDIO.MISC,SOUND[INV.PIRATE_SWORD]=CONST_AUDIO.MISC,SOUND[INV.SWORD_WOOD]=CONST_AUDIO.MISC,SOUND[INV.SWORD]=CONST_AUDIO.MISC,SOUND[INV.LAVA_SWORD]=CONST_AUDIO.MISC,SOUND[INV.LAVA_SPEAR]=CONST_AUDIO.MISC,SOUND[INV.SWORD_GOLD]=CONST_AUDIO.MISC,SOUND[INV.SWORD_DIAMOND]=CONST_AUDIO.MISC,SOUND[INV.SWORD_AMETHYST]=CONST_AUDIO.MISC,SOUND[INV.SWORD_REIDITE]=CONST_AUDIO.MISC,SOUND[INV.CRAB_SPEAR]=CONST_AUDIO.MISC,SOUND[INV.WOOD_SPEAR]=CONST_AUDIO.MISC,SOUND[INV.SPEAR]=CONST_AUDIO.MISC,SOUND[INV.GOLD_SPEAR]=CONST_AUDIO.MISC,SOUND[INV.DIAMOND_SPEAR]=CONST_AUDIO.MISC,SOUND[INV.DRAGON_SPEAR]=CONST_AUDIO.MISC,SOUND[INV.AMETHYST_SPEAR]=CONST_AUDIO.MISC,SOUND[INV.AMETHYST_REIDITE]=CONST_AUDIO.MISC,SOUND[INV.HAMMER]=CONST_AUDIO.MISC,SOUND[INV.HAMMER_GOLD]=CONST_AUDIO.MISC,SOUND[INV.HAMMER_DIAMOND]=CONST_AUDIO.MISC,SOUND[INV.HAMMER_AMETHYST]=CONST_AUDIO.MISC,SOUND[INV.HAMMER_REIDITE]=CONST_AUDIO.MISC,SOUND[INV.SUPER_HAMMER]=CONST_AUDIO.MISC,SOUND[INV.DRAGON_SWORD]=CONST_AUDIO.MISC,SOUND[INV.PITCHFORK2]=CONST_AUDIO.MISC,SOUND[INV.PITCHFORK]=CONST_AUDIO.MISC,SOUND[INV.SHOVEL]=CONST_AUDIO.SHOVEL,SOUND[INV.SHOVEL_GOLD]=CONST_AUDIO.SHOVEL,SOUND[INV.SHOVEL_DIAMOND]=CONST_AUDIO.SHOVEL,SOUND[INV.SHOVEL_AMETHYST]=CONST_AUDIO.SHOVEL,SOUND_NATURE=[],SOUND_NATURE[0]=0,SOUND_NATURE[1]=1,SOUND_NATURE[2]=1,SOUND_NATURE[3]=1,SOUND_NATURE[4]=0,SOUND_NATURE[5]=0,SOUND_NATURE[6]=0,SOUND_NATURE[7]=0,SOUND_NATURE[8]=0,SOUND_NATURE[9]=0,SOUND_NATURE[10]=1,SOUND_NATURE[11]=1,SOUND_NATURE[12]=1,SOUND_NATURE[13]=1,SOUND_NATURE[14]=1,SOUND_NATURE[15]=1,SOUND_NATURE[16]=0,SOUND_NATURE[17]=0,SOUND_NATURE[18]=0,SOUND_NATURE[19]=0,SOUND_NATURE[20]=0,SOUND_NATURE[21]=0,SOUND_NATURE[22]=0,SOUND_NATURE[23]=1,SOUND_NATURE[24]=1,SOUND_NATURE[25]=1,SOUND_NATURE[26]=1,SOUND_NATURE[27]=1,SOUND_NATURE[28]=1,SOUND_NATURE[29]=1,SOUND_NATURE[30]=1,SOUND_NATURE[31]=1,SOUND_NATURE[32]=1,SOUND_NATURE[33]=1,SOUND_NATURE[34]=1,SOUND_NATURE[35]=1,SOUND_NATURE[36]=1,SOUND_NATURE[37]=1,SOUND_NATURE[38]=1,SOUND_NATURE[40]=0,SOUND_NATURE[41]=0,SOUND_NATURE[42]=0,SOUND_NATURE[50]=1,SOUND_NATURE[51]=1,SOUND_NATURE[52]=1,SOUND_NATURE[55]=0,SOUND_NATURE[56]=0,SOUND_NATURE[57]=0,SOUND_NATURE[58]=0,SOUND_BUILD=[],SOUND_BUILD[ITEMS.PLANT]=0,SOUND_BUILD[ITEMS.FIRE]=0,SOUND_BUILD[ITEMS.TOTEM]=0,SOUND_BUILD[ITEMS.BIG_FIRE]=0,SOUND_BUILD[ITEMS.SEED]=-1,SOUND_BUILD[ITEMS.WHEAT_SEED]=-1,SOUND_BUILD[ITEMS.WORKBENCH]=0,SOUND_BUILD[ITEMS.WALL]=0,SOUND_BUILD[ITEMS.BRIDGE]=0,SOUND_BUILD[ITEMS.PLOT]=0,SOUND_BUILD[ITEMS.WINDMILL]=1,SOUND_BUILD[ITEMS.WELL]=1,SOUND_BUILD[ITEMS.STONE_WALL]=1,SOUND_BUILD[ITEMS.GOLD_WALL]=1,SOUND_BUILD[ITEMS.DIAMOND_WALL]=1,SOUND_BUILD[ITEMS.AMETHYST_WALL]=1,SOUND_BUILD[ITEMS.REIDITE_WALL]=1,SOUND_BUILD[ITEMS.SPIKE]=0,SOUND_BUILD[ITEMS.STONE_SPIKE]=1,SOUND_BUILD[ITEMS.GOLD_SPIKE]=1,SOUND_BUILD[ITEMS.DIAMOND_SPIKE]=1,SOUND_BUILD[ITEMS.AMETHYST_SPIKE]=1,SOUND_BUILD[ITEMS.REIDITE_SPIKE]=1,SOUND_BUILD[ITEMS.WOOD_DOOR]=0,SOUND_BUILD[ITEMS.STONE_DOOR]=1,SOUND_BUILD[ITEMS.GOLD_DOOR]=1,SOUND_BUILD[ITEMS.DIAMOND_DOOR]=1,SOUND_BUILD[ITEMS.AMETHYST_DOOR]=1,SOUND_BUILD[ITEMS.REIDITE_DOOR]=1,SOUND_BUILD[ITEMS.WOOD_DOOR_SPIKE]=0,SOUND_BUILD[ITEMS.STONE_DOOR_SPIKE]=1,SOUND_BUILD[ITEMS.GOLD_DOOR_SPIKE]=1,SOUND_BUILD[ITEMS.DIAMOND_DOOR_SPIKE]=1,SOUND_BUILD[ITEMS.AMETHYST_DOOR_SPIKE]=1,SOUND_BUILD[ITEMS.REIDITE_DOOR_SPIKE]=1,SOUND_BUILD[ITEMS.FURNACE]=1,SOUND_BUILD[ITEMS.RESURRECTION]=1,SOUND_BUILD[ITEMS.EMERALD_MACHINE]=1,SOUND_BUILD[ITEMS.CHEST]=0,SOUND_BUILD[ITEMS.BREAD_OVEN]=1;var AUDIO={DIG:{sound:null,path:["audio/ambience.mp3"],sprite:{d0:[90086,300,!1],d1:[90391,300,!1],d2:[90684,300,!1]},sample:{d0:CONST_AUDIO.PLAYERS,d1:CONST_AUDIO.PLAYERS,d2:CONST_AUDIO.PLAYERS}},PUNCH:{sound:null,path:["audio/ambience.mp3"],sprite:{p0:[89303,300,!1],p1:[89549,300,!1],p2:[89815,300,!1]},sample:{p0:CONST_AUDIO.PLAYERS,p1:CONST_AUDIO.PLAYERS,p2:CONST_AUDIO.PLAYERS}},WEAPON:{sound:null,path:["audio/ambience.mp3"],sprite:{w0:[88195,300,!1],w1:[88473,300,!1],w2:[88751,300,!1],w3:[89025,300,!1]},sample:{w0:CONST_AUDIO.PLAYERS,w1:CONST_AUDIO.PLAYERS,w2:CONST_AUDIO.PLAYERS,w3:CONST_AUDIO.PLAYERS}},AMBIENCE:{sound:null,path:["audio/ambience.mp3"],sprite:{cook:[100,2800,!0],seaday:[3100,8800,!0],seanight:[19882,8301,!0],forestday:[32604,21890,!0],forestnight:[54524,11393,!0],snowday:[66961,21223,!0],snownight:[66961,21223,!0],fire:[12356,6965,!0],swim:[28380,1797,!0],sand:[30562,655,!0],walk:[31658,813,!0],snow:[66014,925,!0],hwood:[91022,400,!1],hand:[91431,400,!1],hstone:[92249,500,!1]},sample:{cook:1,seaday:1,seanight:1,forestday:1,forestnight:1,snowday:1,snownight:1,fire:CONST_AUDIO.PLAYERS,swim:CONST_AUDIO.PLAYERS,sand:CONST_AUDIO.PLAYERS,walk:CONST_AUDIO.PLAYERS,snow:CONST_AUDIO.PLAYERS,hwood:CONST_AUDIO.ITEMS,hand:CONST_AUDIO.ITEMS,hstone:CONST_AUDIO.ITEMS}}},SoundArea=function(e,t,i,r,a,n,o,s,_,T,E){this.r=1,this.delay=e,this.max_delay=e,this.night=t,this.day=i,this.fade=r,this.r_base=a,this.r_seed=n,this.player=o,this.transition_delay=s,this.source=_,this.source.lx=_.x+_.w,this.source.by=_.y+_.h,this.outside_box=T,this.inside_box=E,this.inside=0,this.hackish={d:5,m:5},this.effect=function(){if(this.delay-=delta,this.delay<0){this.delay=this.max_delay;var e=AUDIO.AMBIENCE.sound.playing(this.night),t=AUDIO.AMBIENCE.sound.playing(this.day);if(e&&!t){var i=this.player.volume(this.night)*VOLUME.AMB,r=(Math.random()*this.r_seed+this.r_base)*VOLUME.AMB;this.player.fade(i,r,this.fade,this.night)}else if(!e&&t){i=this.player.volume(this.day)*VOLUME.AMB,r=(Math.random()*this.r_seed+this.r_base)*VOLUME.AMB;this.player.fade(i,r,this.fade,this.day)}}},this.transition=function(){if(this.delay=this.max_delay,this.hackish.d=this.hackish.m,world.time){if(this.player.fade(0,this.r_base*VOLUME.AMB,this.transition_delay,this.night),this.player.play(this.night),this.player.playing(this.day)){var e=this.player.volume(this.day)*VOLUME.AMB;this.player.fade(e,0,this.transition_delay,this.day)}}else if(this.player.fade(0,this.r_base*VOLUME.AMB,this.transition_delay,this.day),this.player.play(this.day),this.player.playing(this.night)){e=this.player.volume(this.night)*VOLUME.AMB;this.player.fade(e,0,this.transition_delay,this.night)}},this.check=function(e){if(this.inside)if(Utils.inside_box(e,this.outside_box))!audio.transition&&world.clock.now<CONST_AUDIO.DISABLE_EFFECT&&(world.time?this.player.playing(this.night)||(this.hackish.d-=delta,this.hackish.d<0&&this.transition()):this.player.playing(this.day)||(this.hackish.d-=delta,this.hackish.d<0&&this.transition()));else{if(this.inside=0,this.player.playing(this.night)){var t=this.player.volume(this.night)*VOLUME.AMB;this.player.fade(t,0,this.transition_delay,this.night)}if(this.player.playing(this.day)){t=this.player.volume(this.day)*VOLUME.AMB;this.player.fade(t,0,this.transition_delay,this.day)}}else Utils.inside_box(e,this.inside_box)&&(this.inside=1,!audio.transition&&world.clock.now<CONST_AUDIO.DISABLE_EFFECT&&this.transition())},this.update=function(e,t){var i,r;i=e.x<this.source.x?audio.get_x(this.source.x):e.x>this.source.lx?audio.get_x(this.source.lx):t.x,r=e.y<this.source.y?audio.get_y(this.source.y):e.y>this.source.by?audio.get_y(this.source.by):t.y,this.player.pos(i,r,-.5,this.night),this.player.pos(i,r,-.5,this.day)}};SOUND_PLAYER={DELAY_SWIM:.4,DELAY_SAND:.2,DELAY_WALK:.2,DELAY_SNOW:.2,FADE_SWIM:300,FADE_SAND:100,FADE_WALK:100,FADE_SNOW:100,WALK:0,SWIM:1,SAND:2,SNOW:3,FACTOR:4,FACTOR2:2};var SoundPlayerEffect=function(e,t,i){this.mom=e,this.c=0,this.player=t,this.ids=i,this.max=i.length,this.play=function(){this.c=(this.c+1)%this.max;var e=this.ids[this.c];this.mom.update_pos(this.player,e),this.player.play(e)}},SoundPlayer=function(e){this.free=1,this.uid=0,this.mode=-1,this.swim=audio.sample.swim[e],this.sand=audio.sample.sand[e],this.walk=audio.sample.walk[e],this.snow=audio.sample.snow[e],this.punch=new SoundPlayerEffect(this,AUDIO.PUNCH.sound,audio.samples.punch[e]),this.weapon=new SoundPlayerEffect(this,AUDIO.WEAPON.sound,audio.samples.weapon[e]),this.dig=new SoundPlayerEffect(this,AUDIO.DIG.sound,audio.samples.dig[e]),this.sid=e,this.x=0,this.y=0,this.move=0,this.delay=SOUND_PLAYER.DELAY,this.pos={x:0,y:0},this.ambience=AUDIO.AMBIENCE.sound,this.swing=function(e){e===CONST_AUDIO.HAND?this.punch.play():e===CONST_AUDIO.MISC?this.weapon.play():e===CONST_AUDIO.SHOVEL&&this.dig.play()},this.detect_position=function(e){return e.dist_sand>0?SOUND_PLAYER.SAND:e.dist_water>0?SOUND_PLAYER.SWIM:e.dist_winter>0||e.dist_lava>0?SOUND_PLAYER.SNOW:SOUND_PLAYER.WALK},this.init=function(e){this.free=0,this.uid=e;var t=world.fast_units[e];t.sid=this.sid,this.mode=this.detect_position(t),this.pos.x=t.x,this.pos.y=t.y},this.clean=function(){this.free=1,this.mode=-1,this.ambience.stop(this.swim),this.ambience.stop(this.sand),this.ambience.stop(this.walk),this.ambience.stop(this.snow)},this.fade=function(e,t){var i=this.ambience.volume(e)*VOLUME.FX;this.ambience.fade(i,0,t,e)},this.update_pos=function(e,t){this.move&&this.sid&&e.pos(this.x,this.y,-.5,t)},this.effect=function(e,t,i,r,a,n,o){if(this.delay=n,r&&this.mode===a){var s=this.ambience.volume(e)*VOLUME.FX;if(this.move){var _=(Math.random()*i+t)*VOLUME.FX;this.ambience.fade(s,_,o,e)}else this.ambience.fade(s,0,o,e)}else if(this.mode!=a&&this.move)this.ambience.fade(0,(t+i)*VOLUME.FX,o,e);else if(this.move){s=this.ambience.volume(e)*VOLUME.FX,_=(Math.random()*i+t)*VOLUME.FX;this.ambience.fade(s,_,o,e)}this.update_pos(this.ambience,e),this.ambience.play(e)},this.update=function(){var e=world.fast_units[this.uid];if(this.delay-=delta,!(this.delay>0)){var t=0;e.x!=this.pos.x||e.y!=this.pos.y?(this.move||(t=1,this.move=1),this.x=audio.get_x_ext(e.x,SOUND_PLAYER.FACTOR2),this.y=audio.get_y_ext(e.y,SOUND_PLAYER.FACTOR2)):this.move&&(t=1,this.move=0),this.pos.x=e.x,this.pos.y=e.y,mode=this.detect_position(e),mode!=this.mode&&(this.mode===SOUND_PLAYER.SWIM?this.fade(this.swim,SOUND_PLAYER.FADE_SWIM):this.mode===SOUND_PLAYER.SAND?this.fade(this.sand,SOUND_PLAYER.FADE_SAND):this.mode===SOUND_PLAYER.WALK?this.fade(this.walk,SOUND_PLAYER.FADE_WALK):this.mode===SOUND_PLAYER.SNOW&&this.fade(this.snow,SOUND_PLAYER.FADE_SNOW)),mode===SOUND_PLAYER.SWIM?this.effect(this.swim,.08,.3,t,mode,SOUND_PLAYER.DELAY_SWIM,SOUND_PLAYER.FADE_SWIM):mode===SOUND_PLAYER.SAND?this.effect(this.sand,.2,.3,t,mode,SOUND_PLAYER.DELAY_SAND,SOUND_PLAYER.FADE_SAND):mode===SOUND_PLAYER.WALK?this.effect(this.walk,.3,.6,t,mode,SOUND_PLAYER.DELAY_WALK,SOUND_PLAYER.FADE_WALK):mode===SOUND_PLAYER.SNOW&&this.effect(this.snow,.1,.25,t,mode,SOUND_PLAYER.DELAY_SNOW,SOUND_PLAYER.FADE_SNOW),this.mode=mode}},this.check=function(){var e=world.fast_units[this.uid];return!!e||(this.clean(e),!1)}},MyAudio=function(){this.run=0,this.loaded=0,this.transition=0,this.get_x=function(e){return e/world.w*100},this.get_y=function(e){return e/world.h*100},this.get_x_ext=function(e,t){return e=this.get_x(e)-this.ltr.x,this.ltr.x+t*e},this.get_y_ext=function(e,t){return e=Math.abs(this.get_y(e)-this.ltr.y),this.ltr.y+t*e},this.sample={},this.samples={},this.player={},this.play_sample=function(e,t,i,r){for(var a=0;a<t.length;a++){var n=t[a];if(!e.playing(n))return e.pos(i,r,-.5,n),e.play(n),!0}return!1},this.hit=function(e,t,i,r){i=this.get_x_ext(i,SOUND_PLAYER.FACTOR),r=this.get_y_ext(r,SOUND_PLAYER.FACTOR),console.log("HIT",e,t,i,r,SOUND_PLAYER.FACTOR),e?1===t?this.play_sample(this.player.hstone,this.sample.hstone,i,r):0===t&&this.play_sample(this.player.hwood,this.sample.hwood,i,r):this.play_sample(this.player.hand,this.sample.hand,i,r)},this.ltr={x:0,y:0},this.oldp={x:0,y:0},this.area={},this.players=[],this.ambience=function(e,t){for(var i in this.area){var r=this.area[i];r.check(e),r.inside&&(world.clock.now<CONST_AUDIO.DISABLE_EFFECT&&r.effect(),t&&r.update(e,this.ltr),this.transition&&r.transition())}this.transition&&(this.transition=0)},this.hook_players=function(){for(var e=[],t=0;t<this.players.length;t++){(a=this.players[t]).free?e.push(t):a.free||world.fast_units[a.uid]||(a.clean(),e.push(t))}for(var i=world.units[ITEMS.PLAYERS],r=(t=0,0);t<i.length&&r<e.length;t++){var a=i[t];world.mode==WORLD.MODE_HUNGER_GAMES&&"spectator"===world.players[a.id].nickname||-1!==a.sid||a.uid===user.uid||(this.players[e[r]].init(a.uid),r++)}},this.players_effect=function(){this.hook_players();for(var e=0;e<this.players.length;e++){var t=this.players[e];!t.free&&t.check()&&t.update()}},this.update_listener=function(e){return this.oldp.x===e.x&&this.oldp.y===e.y?0:(this.oldp.x=e.x,this.oldp.y=e.y,this.ltr.x=this.get_x(e.x),this.ltr.y=this.get_y(e.y),Howler.pos(this.ltr.x,this.ltr.y,0),1)},this.scheduler=function(){if(this.run&&this.loaded){var e=world.fast_units[user.uid];if(e){e.sid=0;var t=this.update_listener(e);world.mode!==WORLD.MODE_ZOMBIES&&world.mode!==WORLD.MODE_LEGACY&&world.mode!==WORLD.MODE_BR&&this.ambience(e,t),this.players_effect()}}},this.load_sound=function(){for(var e in AUDIO){var t=AUDIO[e];for(var i in"object"==typeof t&&t.path&&(t.sound=new Howl({src:t.path,volume:0,sprite:t.sprite})),t.sample){var r=t.sample[i],a=[];console.log(i);for(var n=0;n<r;n++){var o=t.sound.play(i);t.sound.stop(o),t.sound.on("fade",(function(e){this.volume(e)||(console.log(e,"OUT"),this.stop(e))}),o),a.push(o)}a.length>1?audio.sample[i]=a:audio.sample[i]=a[0],audio.player[i]=t.sound}}},this.volume_sample=function(e,t,i){for(var r=0;r<e.length;r++)t.volume(i,e[r])},this.organize_samples=function(e,t,i,r,a,n){for(var o=e,s=0;s<i;s++){var _=o[s]=[];for(j=0;j<r;j++)_[j]=audio.sample[a+j][s],t.sound.volume(n,_[j])}},this.init=function(){audio.load_sound(),audio.samples.punch=[],audio.samples.weapon=[],audio.samples.dig=[],audio.organize_samples(audio.samples.punch,AUDIO.PUNCH,CONST_AUDIO.PLAYERS,3,"p",.15),audio.organize_samples(audio.samples.weapon,AUDIO.WEAPON,CONST_AUDIO.PLAYERS,4,"w",.15),audio.organize_samples(audio.samples.dig,AUDIO.DIG,CONST_AUDIO.PLAYERS,3,"d",.09),audio.volume_sample(audio.sample.hand,audio.player.hand,.15),audio.volume_sample(audio.sample.hwood,audio.player.hwood,.2),audio.volume_sample(audio.sample.hstone,audio.player.hstone,1),audio.area.sea=new SoundArea(CONST_AUDIO.SEA_DELAY,this.sample.seanight,this.sample.seaday,CONST_AUDIO.SEA_FADE,.05,.4,AUDIO.AMBIENCE.sound,CONST_AUDIO.TRANSITION,{x:SPRITE.SEE_BIOME_X,y:SPRITE.WINTER_BIOME_Y,w:world.w,h:world.h},{x:SPRITE.SEE_BIOME_X-2300,y:SPRITE.WINTER_BIOME_Y-4e3,w:world.w,h:world.h},{x:SPRITE.SEE_BIOME_X-1500,y:SPRITE.WINTER_BIOME_Y-2e3,w:world.w,h:world.h}),audio.area.forest=new SoundArea(CONST_AUDIO.FOREST_DELAY,this.sample.forestnight,this.sample.forestday,CONST_AUDIO.FOREST_FADE,.03,.25,AUDIO.AMBIENCE.sound,CONST_AUDIO.TRANSITION,{x:0,y:SPRITE.WINTER_BIOME_Y+800,w:SPRITE.SEE_BIOME_X-2300,h:world.h},{x:-100,y:SPRITE.WINTER_BIOME_Y-300,w:SPRITE.SEE_BIOME_X-100,h:world.h},{x:-100,y:SPRITE.WINTER_BIOME_Y+400,w:SPRITE.SEE_BIOME_X-1400,h:world.h}),audio.area.snow=new SoundArea(CONST_AUDIO.FOREST_DELAY,this.sample.snownight,this.sample.snowday,CONST_AUDIO.SNOW_FADE,.01,.22,AUDIO.AMBIENCE.sound,CONST_AUDIO.TRANSITION,{x:-100,y:-100,w:world.w+200,h:SPRITE.WINTER_BIOME_Y-1e3},{x:-100,y:-100,w:world.w+200,h:SPRITE.WINTER_BIOME_Y+600},{x:-100,y:-100,w:world.w+200,h:SPRITE.WINTER_BIOME_Y+100});for(var e=0;e<CONST_AUDIO.PLAYERS;e++)audio.players[e]=new SoundPlayer(e);audio.players[0].init(user.uid),audio.loaded=1},this.launch=function(){!this.transition&&world.clock.now<CONST_AUDIO.DISABLE_EFFECT&&(this.transition=1)},this.quit=function(){if(this.run&&this.loaded){for(var e in audio.sample){var t=audio.sample[e];if("object"==typeof t)for(var i=0;i<t.length;i++)audio.player[e].stop(t[i]);else audio.player[e].stop(t)}for(i=0;i<audio.players.length;i++)audio.players[i].clean()}},this.select=function(){audio.run?audio.quit():(audio.loaded||audio.init(),audio.players[0].uid=user.uid,audio.players[0].free=0,audio.launch()),audio.run=!audio.run}};mobile=0,document.getElementById("version").innerHTML=CLIENT.VERSION_NUMBER+".3";var ui,MAP=[],fake_world={time:Math.floor(2*Math.random()),items:[]};init_fake_world(),client=new NetworkClient;var world,user,scoreboard,game={is_run:!1},audio=new MyAudio,keyboard=new Keyboard,mouse=new Mouse,delta=0,old_timestamp=0,fps={img:!1,counter:0,delay:0,cycle:60,display:!0},loader=new Loader(can,ctx,(function(){create_images(),game=new Game(can,ctx),(ui=new UI(can,ctx)).login_after(),scoreboard=new Scoreboard(can,ctx),world=new World,user=new User,loader.quit((function(){loader.logo.style.display="none",ui.run()}))}));function draw(e){if(window.requestAnimationFrame(draw),delta=(e-old_timestamp)/1e3,old_timestamp=e,delta=delta>1?1:delta,game.is_run?game.draw():(ctx.clearRect(0,0,canw,canh),loader.is_run?loader.draw():ui.is_run?ui.draw():scoreboard.is_run&&scoreboard.draw()),HackSettings.ListEnabledHacks){ctx.save();let e=20;for(hack in HackSettings)null!=HackSettings[hack].enabled&&HackSettings[hack].enabled&&HackSettings[hack].key&&(ctx.font="18px Baloo Paaji",ctx.strokeStyle="black",ctx.lineWidth=7,ctx.fillStyle="red",ctx.strokeText(hack,0,e),ctx.fillText(hack,0,e),e+=20);Spectator&&(ctx.font="18px Baloo Paaji",ctx.strokeStyle="black",ctx.lineWidth=7,ctx.fillStyle="red",ctx.strokeText("Spectator",0,e),ctx.fillText("Spectator",0,e))}Spectator&&(keyboard.is_bottom()&&(user.cam.y-=50,user.cam.ex-=50),keyboard.is_top()&&(user.cam.y+=50,user.cam.ex+=50),keyboard.is_right()&&(user.cam.x-=50,user.cam.ey-=50),keyboard.is_left()&&(user.cam.x+=50,user.cam.ey+=50))}function refreshAds(){window.YMPB.refresh()}function yollaCallback(){document.getElementById("preroll").style.display="none",client.connect()}window.onbeforeunload=function(){if(game.is_run)return"Are you sure you want quit starve.io ;-; ?"},resize_canvas(),draw(0),window.YMPB?isYolla=1:(window.YMPB=window.YMPB||{},isYolla=0),window.YMPB.que=window.YMPB.que||[],window.aiptag=window.aiptag||{},window.aiptag.consented=!0,window.aiptag.cmd=window.aiptag.cmd||[],window.aiptag.cmd.display=window.aiptag.cmd.display||[],window.aiptag.cmd.player=window.aiptag.cmd.player||[];var fun=function(){adplayer=new aipPlayer({AD_WIDTH:960,AD_HEIGHT:540,AD_FULLSCREEN:!0,AD_CENTERPLAYER:!0,LOADING_TEXT:"loading advertisement",PREROLL_ELEM:function(){return document.getElementById("preroll")},AIP_COMPLETE:function(){client.connect()},AIP_REMOVE:function(){}})};window.aiptag.cmd.player.push(fun);var ___adsvid=0;function check_ads(){xhttp.open("GET","https://cdn.jsdelivr.net/gh/prebid/currency-file@1/latest.json?date=20190929",!0),xhttp.send()}var xhttp=new XMLHttpRequest;xhttp.onreadystatechange=function(){4===this.readyState&&this.status};var DB="https://token.starve.io/";if(environment===environments.DEV)DB="http://localhost:3002/";var __GOOGLE_LOGIN__=0,__FACEBOOK_LOGIN__=1,userLoginType=void 0,userToken=void 0,userId=void 0,userData=void 0,userAlreadyLoggedIn=0;function loginWithGoogle(){window.gapi.auth2.getAuthInstance().signIn()}window.onUserLogin=function(){userAlreadyLoggedIn=1};var ip=void 0,xsolla_options={access_token:"ACCESS_TOKEN"},s=document.createElement("script");s.type="text/javascript",s.async=!0,s.src="https://static.xsolla.com/embed/paystation/1.0.7/widget.min.js",s.addEventListener("load",(function(e){window.XPayStationWidget.init(xsolla_options),window.XPayStationWidget.on("status-done",claimBread)}),!1);var head=document.getElementsByTagName("head")[0];function logWithFacebook(){window.FB.login((function(e){e.authResponse&&window.FB.api("/me",(function(e){userLoginType=__FACEBOOK_LOGIN__,userToken=window.FB.getAuthResponse().accessToken,login(),window.onUserLogin(userId)}))}))}head.appendChild(s),window.fbAsyncInit=function(){login(),console.log("fb async init called")},function(e,t,i){var r,a=e.getElementsByTagName(t)[0];e.getElementById(i)||((r=e.createElement(t)).id=i,r.src="https://connect.facebook.net/en_US/sdk.js",a.parentNode.insertBefore(r,a))}(document,"script","facebook-jssdk");var auth2=void 0,googleUser=void 0,appStart=function(){window.gapi.load("auth2",initSigninV2)},initSigninV2=function(){window.gapi.auth2.init({client_id:"604822901057-k3dp7j5qpl6pnfr86rvi4r2qp20nk1oh.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/userinfo.profile"}).then((e=>{(auth2=e).isSignedIn.listen(signinChanged),auth2.currentUser.listen(userChanged);auth2.isSignedIn.get()&&auth2.signIn(),refreshValues()}))},signinChanged=function(e){},userChanged=function(e){login(),void 0===userToken&&void 0!==googleUser&&(userToken=googleUser.getAuthResponse().id_token,console.log("::: iandev userToken :::",userToken),void 0!==userToken&&(userLoginType=__GOOGLE_LOGIN__,window.onUserLogin(userId))),void 0!==e&&!0===e.isSignedIn()&&(googleUser=e,window.onUserLogin(e.id))},refreshValues=function(){auth2&&(googleUser=auth2.currentUser.get())};function logout(){userLoginType===__FACEBOOK_LOGIN__&&window.FB.getUserID()&&window.FB.logout(),userLoginType===__GOOGLE_LOGIN__&&void 0!==googleUser&&(window.gapi.auth2.getAuthInstance().signOut(),googleUser=void 0),userId=void 0,userToken=void 0,userLoginType=void 0,ui.kit=0,ui.bread=0,ui.score=0,ui.unlock_cosmetics(),onUserLogout()}function login(){window.FB.init({appId:"642017356260407",cookie:!0,xfbml:!0,version:"v15.0"}),void 0===userId&&getUserId()}function AutoFeed(){1===client.socket.readyState&&HackSettings.AutoRespawn&&ui.play_game()}function HackInterval(){let e=world.fast_units[user.uid];if(e||Spectator||client.socket.send(JSON.stringify([11])),e){if(HackSettings.AutoSpike.enabled){for(let e=0,r=HackSettings.AutoSpike.preferences;e<r.length;e++){var t=r[e];switch(t){case"Reidite Spike":t=213;break;case"Amethyst Spike":t=117;break;case"Diamond Spike":t=164;break;case"Gold Spike":t=163;break;case"Stone Spike":t=162;break;case"Wood Spike":t=154;break;case"Wood Wall":t=156;break;case"Nothing":t=-1}if(-1!==t&&user.inv.n[t]){var i=t;break}}if(i){let t=2*Math.PI,r=Math.floor((e.angle+t)%t*255/t);if(HackSettings.AutoSpike.mode||client.socket.send(JSON.stringify([10,i,r,0])),HackSettings.AutoSpike.mode)for(let e=0;e<30;e++)client.socket.send(JSON.stringify([10,i,(e+r)%255,0])),client.socket.send(JSON.stringify([10,i,(r-e+255)%255,0])),client.socket.send(JSON.stringify([10,i,r,0]))}}if(HackSettings.AutoBridge.enabled){let t=2*Math.PI,i=Math.floor((e.angle+t)%t*255/t);client.socket.send(JSON.stringify([10,119,i,1]))}!HackSettings.SwordInChest.enabled||1!=HelperFns.isPlayerHoldingWeapon(e,!1)&&2!=HelperFns.isPlayerHoldingWeapon(e,!1)||(client.socket.send(JSON.stringify([10,161,35,0])),client.socket.send(JSON.stringify([10,161,235,0])),client.socket.send(JSON.stringify([10,161,100,0])),client.socket.send(JSON.stringify([10,161,169,0]))),HackSettings.AutoCraft.enabled&&!user.craft.crafting&&client.socket.send(JSON.stringify([7,lastCrafted])),HackSettings.AutoRecycle.enabled&&!user.craft.crafting&&client.socket.send(JSON.stringify([29,lastRecycled]))}}function getUserId(){try{window.FB&&window.FB.getUserID()&&(userId=window.FB.getUserID(),void 0===userToken&&window.FB.getLoginStatus((function(){userLoginType=__FACEBOOK_LOGIN__,userToken=window.FB.getAuthResponse().accessToken,window.onUserLogin(userId)})))}catch(e){}try{userId=googleUser.getBasicProfile().getId()}catch(e){}}function openXsolla(e){if(userId){var t=new XMLHttpRequest;t.open("GET",DB+"xsolla?userid="+userId+"&item="+e),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){4==this.readyState&&200==this.status&&"0"!==t.responseText&&(xsolla_options.access_token=t.responseText,window.XPayStationWidget.init(xsolla_options),window.XPayStationWidget.open())},t.send()}}function getUserDetails(e){var t=new XMLHttpRequest;t.open("GET",DB+"login?token="+userToken+"&type="+userLoginType),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){4===this.readyState&&200===this.status&&"0"!==t.responseText&&e(JSON.parse(t.responseText))},t.send()}function rebootServer(){var e=new XMLHttpRequest;e.open("GET",DB+"rebootServer?token="+userToken+"&userid="+userId),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.onreadystatechange=function(){4===this.readyState&&200===this.status&&"0"!==e.responseText&&(location.href=document.getElementById("serverAddressInput").value)},e.send()}function regionPreference(e){var t=new XMLHttpRequest;t.open("GET",DB+"setRegion?token="+userToken+"&userid="+userId+"&region="+e),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){4===this.readyState&&200===this.status&&("0"!==t.responseText?ui.select_subview(ui.__SERVER_DURATION__):ui.select_subview(ui.__GAME__))},t.send()}function buySpin(e,t){if(!(ui.spin>0))if(ui.bread<t)ui.select_subview(ui.__BUY__);else{ui.spin=2,ui.spin_effect=0,ui.spin_target=100;var i=new XMLHttpRequest;i.open("GET",DB+"buySpin?token="+userToken+"&userid="+userId+"&spin="+e),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){if(4==this.readyState&&200==this.status)if("0"!==i.responseText){var e=JSON.parse(i.responseText);ui.play_spin(e.rand*Math.PI*2,e.type,e.id),ui.bread-=t}else ui.spin=0},i.send()}}function buyNameChanger(){if(!(ui.bread<300&&ui.firstName>0)){var e=document.getElementById("account_nickname_input").value.trim();if(document.getElementById("account_nickname_input").value=e,!(e.length<1||e.length>20)){var t=new XMLHttpRequest;t.open("GET",DB+"changeNickname?token="+userToken+"&userid="+userId+"&nickname="+encodeURIComponent(e)),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){if(4==this.readyState&&200==this.status&&"0"!==t.responseText){var e=Number(t.responseText);e>0&&(ui.bread-=e),ui.firstName=1,ui.select_subview(ui.__PROFILE__)}},t.send()}}}function buyKit(e,t){if(ui.bread<t)ui.select_subview(ui.__BUY__);else{var i=new XMLHttpRequest;i.open("GET",DB+"buyKit?token="+userToken+"&userid="+userId+"&kit="+e),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){if(4==this.readyState&&200==this.status&&"0"!==i.responseText){var e=JSON.parse(i.responseText);ui.bread-=t,ui.kit=Date.now()+Number(e)}},i.send()}}function claimBread(){var e=new XMLHttpRequest;e.open("GET",DB+"claimBread?userid="+userId),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.onreadystatechange=function(){if(4==this.readyState&&200==this.status&&"0"!==e.responseText){var t=Number(e.responseText);isNaN(t)||(ui.bread=t)}},e.send()}function getBreadAndScore(){var e=new XMLHttpRequest;e.open("GET",DB+"getBreadAndScore?userid="+userId),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.onreadystatechange=function(){if(4==this.readyState&&200==this.status&&"0"!==e.responseText){var t=JSON.parse(e.responseText),i=t.b-ui.bread;ui.bread=t.b,ui.score=t.s,ui.lvl=ui.level_formula(ui.score),ui.xp_dest=ui.xp_formula(ui.score),ui.xp=0,document.getElementById("breadWonInner").innerHTML=""+i}},e.send()}function sendCheat(){xhr.open("GET",DB+"getScore?userid="+userId),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.onreadystatechange=function(){if(4==this.readyState&&200==this.status&&"0"!==xhr.responseText)JSON.parse(xhr.responseText)},xhr.send()}function getLeaderboard(e,t,i,r){if(e=void 0===e?ui.leaderboard_range:e,t=void 0===t?ui.leaderboard_mode:t,i=void 0===i?ui.leaderboard_sorted:i,r=void 0===r?ui.leaderboard_season:r,e!==ui.leaderboard_range||t!==ui.leaderboard_mode||i!==ui.leaderboard_sorted||r!==ui.leaderboard_season){ui.leaderboard_range=e,ui.leaderboard_mode=t,ui.leaderboard_sorted=i,ui.leaderboard_season=r,ui.LEADERBOARD_SEASON1===r?r="0":ui.LEADERBOARD_SEASON2===r?r="1":ui.LEADERBOARD_SEASON3===r?r="2":ui.LEADERBOARD_SEASON4===r&&(r="3"),ui.LEADERBOARD_TOTAL===t?t="total":ui.LEADERBOARD_NORMAL===t?t="normal":ui.LEADERBOARD_ZOMBIE===t?t="zombie":ui.LEADERBOARD_VAMPIRE===t?t="vampire":ui.LEADERBOARD_FOREST===t&&(t="forest"),ui.LEADERBOARD_ALL===e&&(e="all"),ui.LEADERBOARD_WEEK===e&&(e="week"),ui.LEADERBOARD_TODAY===e&&(e="today"),ui.LEADERBOARD_KILL===i?i="kill":ui.LEADERBOARD_SCORE===i?i="score":ui.LEADERBOARD_TIME===i&&(i="time");var a=new XMLHttpRequest;a.open("GET",DB+"leaderboard?range="+e+"&mode="+t+"&sort="+i+"&season="+r),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){if(4==this.readyState&&200==this.status&&"0"!==a.responseText){for(var e=JSON.parse(a.responseText),t="",i=0;i<e.length;i++){line=e[i];var r=line[1];-1===r.indexOf("Starver#")&&(r=window.decodeURIComponent(window.escape(window.atob(r)))),t+='<div class="lineLeaderboard">',t+='<div class="rank">',t+=i+1+"",t+="</div>",t+='<div class="name">',t+=r,t+="</div>",t+='<div class="lvl">',t+=ui.level_formula(line[6])+1+"",t+="</div>",t+='<div class="kills">',t+=line[5]+"",t+="</div>",t+='<div class="time">',t+=line[4]+"",t+="</div>",t+='<div class="score">',t+=line[3]+"",t+="</div>",t+="</div>"}document.getElementById("leaderboard").innerHTML=t}},a.send()}}window.onload=function(){appStart()};var canvas=document.getElementById("game_canvas"),canvasR=canvas.getContext("2d");canvasR.drawImage=new Proxy(canvasR.drawImage,{apply(){return HackSettings.Xray.enabled&&(arguments[1].globalAlpha=HackSettings.Xray.opacity),Reflect.apply(...arguments)}}),HelperFns.LoadHack();